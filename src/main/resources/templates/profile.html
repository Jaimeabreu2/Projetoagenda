<!doctype html>
<html lang="pt-BR" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Perfil ‚Äî Projeto Agenda</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="stylesheet" href="css/profile.css"/>
    <style>

    </style>
</head>
<body class="profile-page">
<!-- Barra lateral: atalhos r√°pidos para navegar entre telas (use Tab para focar) -->
<nav class="app-sidebar" aria-label="Barra de navega√ß√£o">
    <a class="icon-btn" th:href="@{/calendarComAgenda}" title="Calend√°rio" aria-label="Calend√°rio">üìÖ</a>
    <button class="icon-btn" title="Tarefas" aria-label="Tarefas">‚úÖ</button>
    <a class="icon-btn" th:href="@{/profile}" title="Meu Perfil" aria-label="Meu Perfil">üë§</a>
    <div class="sidebar-sep" aria-hidden="true"></div>
    <a class="create-btn" th:href="@{/addEventScreen}" title="Adicionar evento" aria-label="Adicionar evento">+</a>

</nav>

<!-- Conte√∫do principal: √°rea de edi√ß√£o do perfil.
     Observa√ß√µes r√°pidas:
     - Campos obrigat√≥rios usam "required".
     - O e-mail institucional √© somente leitura por design. -->
<main class="profile-wrap" role="main" aria-labelledby="profileTitle">
    <section class="profile-card" aria-labelledby="profileTitle">
        <div class="avatar" aria-hidden="false" id="avatarInitials">JS</div>
        <!-- upload de avatar (preview client-side) -->
        <div style="text-align:center;margin-top:8px">
            <input id="avatarInput" type="file" accept="image/*" aria-label="Enviar foto de perfil"
                   style="display:none"/>
            <button id="changeAvatarBtn" class="btn secondary" type="button" style="font-size:13px;padding:8px 12px">
                Alterar foto
            </button>
        </div>
        <h2 id="profileTitle" style="text-align:center;margin:6px 0">Seu perfil</h2>
        <div style="text-align:center" class="small">Gerencie suas informa√ß√µes b√°sicas</div>

        <div class="profile-actions" aria-hidden="false">
            <a class="btn" id="goCalendar" th:href="@{/calendarComAgenda}">Ir ao calend√°rio</a>
            <button class="btn secondary" id="logoutBtn" type="button">Sair</button>
        </div>
    </section>

    <section class="profile-main" aria-label="Editar informa√ß√µes">
        <h3 style="margin-top:0">Informa√ß√µes b√°sicas</h3>

        <!-- O FORMUL√ÅRIO, CHATGPT -->
        <div id="profileForm" autocomplete="on" novalidate th:action="@{/profile}" method="post">

            <span th:if="${warning}" th:text="${warning}" role="alert"
                  style="display:block;background:#fff3cd;color:#856404;border:1px solid #ffeeba;
                  padding:10px;border-radius:6px;margin-bottom:12px;text-align:center;">
            </span>

            <div class="field full">
                <label for="fullName">Nome completo</label>
                <div class="input">
                    <input id="fullName" name="name" type="text"
                           th:value="${usuario.nome}" required/>
                </div>
            </div>

            <div class="field full">
                <label for="email">E-mail institucional</label>
                <div class="input">
                    <input id="email" name="email" type="email"
                           th:value="${usuario.email}" readonly/>
                </div>

                <div class="small-note email-note">O e-mail institucional n√£o pode ser alterado aqui.</div>
            </div>

            <!-- campos de curso, telefone e ano de ingresso removidos conforme solicitado -->

            <hr/>

            <div class="field full">
                <h4 style="margin:8px 0">Alterar senha</h4>
            </div>

            <div style="display:flex;flex-direction:column;gap:10px;">
                <input type="password" name="pwd" placeholder="Senha atual" required
                       style="background-color:#FBFFF9;">

                <input type="password" name="new_pwd" placeholder="Nova senha" required
                       style="background-color:#FBFFF9;">

                <input type="password" name="confirm_pwd" placeholder="Confirmar nova senha" required
                       style="background-color:#FBFFF9;">
            </div>

            <div id="pwdHint" class="small-note">Deixe em branco se n√£o quiser alterar a senha.</div>
        </div>

        <hr/>
        <div class="field full">
            <h4 style="margin:8px 0">Prefer√™ncias</h4>
        </div>

        <div class="pref-list field full" aria-labelledby="prefTitle">
            <label>
                <input id="notifyEmail" type="checkbox"
                       th:checked="${usuario.notificacaoEmail}">
                Receber notifica√ß√µes por e-mail
            </label>

            <label>
                <input id="notifyWeekly" type="checkbox"
                       th:checked="${usuario.resumoSemanal}">
                Resumo semanal
            </label>
        </div>

        <div class="field full" style="font-size:13px;color:var(--muted);margin-top:6px">
            <div style="display:flex; align-items:center; gap:5px; white-space:nowrap;">
                Conta criada em:
                <input style="font-size:12px;"
                       th:value="${#temporals.format(usuario.dataCadastro, 'dd/MM/yyyy')}">
            </div>

            <div style="display:flex; align-items:center; gap:10px; margin-top:6px; white-space:nowrap;">
                √öltimo login:
                <input style="font-size:12px;"
                       th:value="${#temporals.format(usuario.ultimoLogin, 'dd/MM/yyyy')}">
            </div>
        </div>

        <div class="actions-row">

            <!-- O BOT√ÉO, CHATGPT -->
            <button type="submit" class="btn" id="saveProfile">Salvar altera√ß√µes</button>
            <!-- FIM DO BOT√ÉO, CHATGPT -->

            <a class="btn secondary" th:href="@{/calendarComAgenda}">Voltar</a>
            <button type="button" id="deleteAccountBtn" class="btn secondary"
                    style="color:var(--danger);border-color:rgba(185,28,28,0.08)">Excluir conta
            </button>
        </div>

        <div id="error" class="danger-msg" role="alert"></div>
        </form>
        <!-- FIM DO FORMUL√ÅRIO, CHATGPT -->
    </section>

    <!-- Toast de sucesso (perfil) -->
    <div id="saveSuccess" class="toast" role="status" aria-live="polite">Altera√ß√µes salvas</div>
</main>

<script src="js/accessibility.js"></script>
</body>
</html>