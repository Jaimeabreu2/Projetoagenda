<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Agenda — Criar conta</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="login-page">
<main class="login-wrap" aria-labelledby="signup-title">
    <section class="hero" aria-hidden="false">
        <div class="brand">
            <div class="logo" aria-hidden="true">Ag</div>
            <div>
                <div style="font-weight:700">Projeto Agenda</div>
                <div class="small">Agenda acadêmica — organize suas aulas e compromissos</div>
            </div>
        </div>

        <h1 id="signup-title">Crie sua conta</h1>
        <p>Cadastre-se para começar a usar seu calendário acadêmico.</p>
        <div class="small" style="margin-top:18px">Dica: prefira usar seu e-mail institucional.</div>
    </section>

    <section class="card" aria-labelledby="form-title">
        <h2 id="form-title">Crie sua conta</h2>

        <span th:if="${warning}" th:text="${warning}" role="alert"
              style="display:block;background:#fff3cd;color:#856404;border:1px solid #ffeeba;
      padding:10px;border-radius:6px;margin-bottom:12px;text-align:center;">
</span>

        <form id="signupForm" th:action="@{/signup}" method="post" autocomplete="on" novalidate>
            <label for="nomeCompleto">Nome completo</label>
            <input id="nomeCompleto" name="nome" type="text" placeholder="Seu nome completo" required/>

            <label for="signupEmail">E-mail institucional</label>
            <input id="signupEmail" name="email" type="email" placeholder="seunome@aluno.uece.br" required/>

            <label for="signupSenha">Senha</label>
            <input id="signupSenha" name="senha" type="password" placeholder=" ••••••••" minlength="6" maxlength="20"
                   required/>

            <label for="signupSenha2">Confirmar senha</label>
            <div class="input">
                <input id="signupSenha2" name="pass2" type="password" placeholder="••••••••" minlength="6"
                       maxlength="20" required aria-required="true"/>
                <button type="button" class="eye" aria-label="Mostrar senha"><i class="fa-solid fa-eye"></i></button>
            </div>

            <div id="pwdMatch" class="small" aria-live="polite" style="margin-top:6px;color:#666"></div>

            <div style="display:flex;gap:10px;margin-top:8px">
                <button type="submit" class="btn" id="signupSubmit">Criar conta</button>
                <a class="btn secondary" th:href="@{/login}" id="backToLogin">Voltar</a>
            </div>

            <div class="error" id="signupError" role="alert"></div>
            <div class="help">Ao criar a conta, você poderá acessar seu calendário acadêmico.</div>
        </form>
    </section>
</main>

<script>
    (function () {
        const signupForm = document.getElementById('signupForm');
        const signupSubmit = document.getElementById('signupSubmit');
        const signupPwd = document.getElementById('signupSenha');
        const signupPwd2 = document.getElementById('signupSenha2');
        const pwdMatch = document.getElementById('pwdMatch');

        // Mostrar/ocultar senha
        document.addEventListener('click', function (e) {
            const eye = e.target.closest('.eye');
            if (!eye) return;
            const input = eye.parentElement.querySelector('input');
            const type = input.type === 'password' ? 'text' : 'password';
            input.type = type;
            eye.innerHTML = type === 'password' ? '<i class="fa-solid fa-eye"></i>' : '<i class="fa-solid fa-eye-slash"></i>';
            eye.setAttribute('aria-pressed', type !== 'password');
        });

        // Verificar se as senhas coincidem
        function checkPasswordsMatch() {
            const a = signupPwd.value;
            const b = signupPwd2.value;
            if (!a && !b) {
                pwdMatch.textContent = '';
                signupSubmit.disabled = false;
                return;
            }
            if (a && b && a === b) {
                pwdMatch.textContent = 'As senhas coincidem.';
                pwdMatch.style.color = '#0a0';
                signupSubmit.disabled = false;
                return;
            }
            if (b) {
                pwdMatch.textContent = 'As senhas não conferem.';
                pwdMatch.style.color = '#c00';
            } else {
                pwdMatch.textContent = '';
            }
            signupSubmit.disabled = true;
        }

        signupPwd.addEventListener('input', checkPasswordsMatch);
        signupPwd2.addEventListener('input', checkPasswordsMatch);

        signupForm.addEventListener('submit', function () {
            signupSubmit.disabled = signupPwd.value !== signupPwd2.value;
        });

        checkPasswordsMatch();
    })();
</script>

<script src="js/accessibility.js"></script>
</body>
</html>
